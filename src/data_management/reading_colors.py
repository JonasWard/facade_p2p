import cv2 as cv
import numpy as np
import csv

colors = []

with open('/Users/jonas/Documents/reps/facade_p2p/src/data_management/color_list.csv', newline='') as csvfile:
    reader = csv.reader(csvfile, delimiter=',', quotechar='|')
    
    for row in reader:
        x,y,z=row
        colors.append({
            "r":int(x),
            "g":int(y),
            "b":int(z),
        })

print(colors)
cell_size = 50

clr_array=np.zeros((cell_size*len(colors), cell_size), dtype=np.uint8)

xs, ys = [np_a for np_a in np.indices( clr_array.shape )]
print(xs)
xs_mod = xs % cell_size.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print(xs_mod)
xs-=xs_mod
xs=xs//cell_size
# xs+=1
print(xs)

r_list, g_list, b_list = [], [], []
for c in colors:
    for k, value in c.items():
        if k == 'r':
            r_list.append(value)
        elif k == 'g':
            g_list.append(value)
        elif k == 'b':
            b_list.append(value)

print(r_list, g_list, b_list)

r_dict, g_dict, b_dict = {}, {}, {}
for i, v in enumerate(r_list):
    r_dict[i]=v

for i, v in enumerate(g_list):
    g_dict[i]=v

for i, v in enumerate(b_list):
    b_dict[i]=v

r_array=np.copy(xs)
g_array=np.copy(xs)
b_array=np.copy(xs)

for k, v in r_dict.items(): r_array[xs==k] = v
for k, v in g_dict.items(): g_array[xs==k] = v
for k, v in b_dict.items(): b_array[xs==k] = v

print(b_array, g_array, r_array)
c_map = (b_array.astype(dtype=np.uint8), g_array.astype(dtype=np.uint8), r_array.astype(dtype=np.uint8))
img = cv.merge(c_map)

print(c_map)

cv.imshow("color vis", img)
cv.waitKey(0)
cv.destroyAllWindows()

def pseudocoloring(img):
    img = cv.applyColorMap(img, cv.COLORMAP_JET)
    return img
     
cv.imshow("color vis", pseudocoloring((xs*(255./len(colors))).astype(np.uint8)))
cv.waitKey(0)
cv.destroyAllWindows()
